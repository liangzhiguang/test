<!DOCTYPE html>
<html>
<head>
    <title>先复制角色再打开ChatGPT,然后粘贴提示词</title>
    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text)
                .then(function () {
                    alert("已复制到剪贴板！");
                })
                .catch(function (error) {
                    console.error("复制失败:", error);
                });
        }

        function readFile(prompt) {
            var file = "prompt.txt";
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file, true);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4 && rawFile.status === 200) {
                    var content = rawFile.responseText;
                    var regex = new RegExp("\\[" + prompt + "开始\\][\\s\\S]*?\\[" + prompt + "结束\\]");
                    var matches = content.match(regex);
                    if (matches && matches.length > 0) {
                        var trimmedContent = matches[0].replace("[" + prompt + "开始]", "").replace("[" + prompt + "结束]", "").trim();
                        copyToClipboard(trimmedContent);
                    } else {
                        alert("未找到指定内容！");
                    }
                }
            };
            rawFile.send();
        }

        window.addEventListener('DOMContentLoaded', function () {
            var file = "prompt.txt";
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file, true);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4 && rawFile.status === 200) {
                    var content = rawFile.responseText;
                    var regex = /\[(.*?)开始\]/g;
                    var matches = content.match(regex);
                    if (matches && matches.length > 0) {
                        var buttonContainer = document.body;
                        matches.forEach(function (match) {
                            var prompt = match.substring(1, match.length - 3);
                            var button = document.createElement("button");
                            button.textContent = "先复制 " + prompt;
                            button.addEventListener('click', function () {
                                readFile(prompt);
                            });
                            buttonContainer.appendChild(button);
                        });
                    }
                }
            };
            rawFile.send();
        });
    </script>
</head>
<body>
</body>
</html>
