<!DOCTYPE html>
<html>
<head>
    <title>ChatGPT Prompt Automation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
        }

        #loadingMessage {
            text-align: center;
            margin-top: 100px;
        }

        #errorMessage {
            color: red;
            text-align: center;
            margin-top: 100px;
        }
    </style>
</head>
<body>
    <h1>ChatGPT Prompt Automation</h1>

    <div id="loadingMessage">Loading...</div>

    <div id="errorMessage"></div>

    <script>
        function redirectToChat() {
            var xhr = new XMLHttpRequest();
            
            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        var url = xhr.responseText;
                        window.location.href = url;
                    } else {
                        document.getElementById('loadingMessage').style.display = 'none';
                        document.getElementById('errorMessage').textContent = 'Failed to retrieve ChatGPT URL.';
                    }
                }
            };
            
            xhr.open('GET', 'url.txt', true);
            xhr.send();
        }
        
        window.onload = function () {
            redirectToChat();
        };

      <iframe id="chatFrame" src="" onload="injectPrompts()" style="display: none;"></iframe>

    <div id="loadingMessage">Loading...</div>

    <div id="errorMessage"></div>

    <script>
        var prompts = [];

        function loadPrompts() {
            var xhr = new XMLHttpRequest();

            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        prompts = xhr.responseText.split('\n');
                        var index = Math.floor(Math.random() * prompts.length);
                        document.getElementById('chatFrame').src = prompts[index];
                    } else {
                        document.getElementById('loadingMessage').style.display = 'none';
                        document.getElementById('errorMessage').textContent = 'Failed to retrieve ChatGPT URL list.';
                    }
                }
            };

            xhr.open('GET', 'url.txt', true);
            xhr.send();
        }

        function injectPrompts() {
            var chatFrame = document.getElementById('chatFrame').contentWindow.document;
            var inputElements = chatFrame.getElementsByTagName('input');

            if (inputElements.length > 0) {
                var inputElement = inputElements[0];
                var prompt = prompts.pop();
                var startWord = '[提示词2]';
                var endWord = '[提示词3]';
                var content = extractContent(prompt, startWord, endWord);

                if (content) {
                    inputElement.value = content;
                    inputElement.form.submit();
                } else {
                    document.getElementById('loadingMessage').style.display = 'none';
                    document.getElementById('errorMessage').textContent = 'Failed to extract prompt content.';
                }
            } else {
                setTimeout(injectPrompts, 1000);
            }
        }
              // 提取内容函数
        function extractContent(text, startWord, endWord) {
            var pattern = new RegExp("\\[" + startWord + "\\](.*?)\\[" + endWord + "\\]\\b", "s");
            var matches = text.match(pattern);
            if (matches && matches.length > 1) {
                return matches[1].trim();
            } else {
                return null;
            }
        }

        window.onload = function () {
            loadPrompts();
        };
    </script>
</body>
</html>
